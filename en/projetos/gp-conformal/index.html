<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://rodolfoviana.com.br name=base><title>
         Uncertainty quantification with Gaussian processes and conformal prediction
        
    </title><meta content="Uncertainty quantification with Gaussian processes and conformal prediction" property=og:title><meta content="Edited version of an article written for the Artificial Neural Networks course, by Prof. Dr. Lucas Ribas, in the master's program of the Computer Science Graduate Program at Unesp" property=og:description><meta content="Edited version of an article written for the Artificial Neural Networks course, by Prof. Dr. Lucas Ribas, in the master's program of the Computer Science Graduate Program at Unesp" name=description><meta content=https://rodolfoviana.com.br/image.png property=og:image><meta content=image/png property=og:image:type><meta content=website property=og:type><meta content=https://rodolfoviana.com.br/en/projetos/gp-conformal/ property=og:url><link href=/favicon.png rel=icon type=image/png><link href=https://rodolfoviana.com.br/fonts.css rel=stylesheet><script src=https://rodolfoviana.com.br/js/codeblock.js></script><script src=https://rodolfoviana.com.br/js/note.js></script><script>MathJax = {
          options: {enableMenu: false},
          loader: {load: ['[tex]/boldsymbol']},
          tex: {
            packages: {'[+]': ['boldsymbol']},
            inlineMath: [['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            processEscapes: true,
            processEnvironments: true,
            }
        }</script><link title="rodolfo viana" href=https://rodolfoviana.com.br/rss.xml rel=alternate type=application/rss+xml><link href=https://rodolfoviana.com.br/theme/dark.css rel=stylesheet><script src=https://rodolfoviana.com.br/js/themetoggle.js></script><script>setTheme("dark");</script><link href=https://rodolfoviana.com.br/main.css media=screen rel=stylesheet><script src=https://rodolfoviana.com.br/js/mobile-menu.js></script><script src=https://rodolfoviana.com.br/js/d3.min.js></script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js></script><script src=https://rodolfoviana.com.br/js/geolocation.js></script><body><div class=content><header><div class=main><a href=https://rodolfoviana.com.br>rodolfo viana</a></div><button aria-label=Menu class=hamburger id=mobile-menu-button><span></span><span></span><span></span></button><nav id=nav-menu><a href=https://rodolfoviana.com.br/en/projetos style=margin-left:.5em>projects</a><a href=https://rodolfoviana.com.br/en/curriculo style=margin-left:.5em>résumé</a><a href=https://rodolfoviana.com.br/en/tags style=margin-left:.5em>tags</a><a onclick="switchLanguage('pt')" title="Voltar para Português" href=javascript:void(0) style=margin-left:.5em>PT</a></nav></header><main><article><div class=title><div class=page-header>Uncertainty quantification with Gaussian processes and conformal prediction<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Published: <time>06-17-2025</time><br><span class=tags-label>Tags:</span><span class=tags> <a class=post-tag href=https://rodolfoviana.com.br/en/tags/machine-learning/>machine learning</a>, <a class=post-tag href=https://rodolfoviana.com.br/en/tags/gaussian-processes/>gaussian processes</a>, <a class=post-tag href=https://rodolfoviana.com.br/en/tags/neural-networks/>neural networks</a> </span></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://rodolfoviana.com.br/en/projetos/gp-conformal/#introduction>Introduction</a><li><a href=https://rodolfoviana.com.br/en/projetos/gp-conformal/#methodology>Methodology</a> <ul><li><a href=https://rodolfoviana.com.br/en/projetos/gp-conformal/#exact-gaussian-processes>Exact Gaussian Processes</a><li><a href=https://rodolfoviana.com.br/en/projetos/gp-conformal/#stochastic-variational-gaussian-process>Stochastic Variational Gaussian Process</a><li><a href=https://rodolfoviana.com.br/en/projetos/gp-conformal/#conformal-prediction>Conformal Prediction</a><li><a href=https://rodolfoviana.com.br/en/projetos/gp-conformal/#test-execution>Test Execution</a></ul><li><a href=https://rodolfoviana.com.br/en/projetos/gp-conformal/#results>Results</a><li><a href=https://rodolfoviana.com.br/en/projetos/gp-conformal/#conclusion>Conclusion</a><li><a href=https://rodolfoviana.com.br/en/projetos/gp-conformal/#references>References</a></ul></div><section class=body><h1 id=introduction>Introduction</h1><p>In regression problems, machine learning models are generally capable of presenting rigorous point predictions; however, they often neglect the quantification of uncertainty inherent to such predictions<sup class=footnote-reference id=fr-1-1><a href=#fn-1>1</a></sup> <sup class=footnote-reference id=fr-2-1><a href=#fn-2>2</a></sup>. This limitation is particularly critical in real applications, where not only prediction accuracy, but also reliability and uncertainty quantification are crucial for informed decision-making<sup class=footnote-reference id=fr-3-1><a href=#fn-3>3</a></sup>.<p>In this scenario, models based on Gaussian processes (GP) stand out as a robust approach<sup class=footnote-reference id=fr-4-1><a href=#fn-4>4</a></sup>. They are capable of providing not only point predictions, but also complete probability distributions for predictions<sup class=footnote-reference id=fr-5-1><a href=#fn-5>5</a></sup>, allowing them to capture both epistemic and aleatoric uncertainty. Epistemic uncertainty refers to uncertainty in the model due to lack of data or knowledge, which can be reduced with more observations, while aleatoric uncertainty is inherent to the data generation process and cannot be reduced, representing the natural noise of the system<sup class=footnote-reference id=fr-6-1><a href=#fn-6>6</a></sup>.<p>Gaussian processes assign probabilistic distribution to functions, so that any finite subset of sample points obeys a multivariate Gaussian distribution<sup class=footnote-reference id=fr-5-2><a href=#fn-5>5</a></sup>. They thus become suitable for constructing prediction intervals, as they delimit the expected range for the true value with a specific probability<sup class=footnote-reference id=fr-4-2><a href=#fn-4>4</a></sup>.<p>In practice, however, intervals extracted directly from a GP may not deliver the desired nominal coverage<sup class=footnote-reference id=fr-7-1><a href=#fn-7>7</a></sup>. It is in this context that conformal prediction presents itself as a complementary approach<sup class=footnote-reference id=fr-8-1><a href=#fn-8>8</a></sup> <sup class=footnote-reference id=fr-9-1><a href=#fn-9>9</a></sup>. It is a statistical technique that allows calibrating prediction intervals to guarantee theoretical coverage properties, regardless of the underlying data distribution or model adequacy<sup class=footnote-reference id=fr-10-1><a href=#fn-10>10</a></sup> <sup class=footnote-reference id=fr-11-1><a href=#fn-11>11</a></sup>.<p>A model configuration that integrates GP and conformal prediction becomes a promising approach for constructing intervals that are simultaneously informative and reliable. In this work, we investigate this configuration: we implement the Neural-Enhanced Gaussian Process (NE-GP) and the Neural-Enhanced Stochastic Variational Gaussian Process (NE-SVGP). For each of these models, we compare the performance of prediction intervals before and after applying the conformal method, in terms of coverage and interval width.<h1 id=methodology>Methodology</h1><p>The implementation of the models proposed in this work follows a hybrid architecture that combines neural networks with Gaussian processes, creating the NE-GP and NE-SVGP models. This approach uses the PyTorch and GPyTorch libraries to implement a two-stage architecture: neural feature extraction followed by Gaussian probabilistic modeling.<p>The hybrid architecture consists of two main integrated components: a feature extractor based on multilayer perceptron (MLP) that transforms input data into higher-level representations, and a GP that operates on these extracted features to provide interval predictions. The MLP is structured with three fully connected layers: an input layer that receives the original data features, two hidden layers with 64 neurons each, applying ReLU activation functions and dropout of 0.1 for regularization, and an output layer with 32 neurons that produces the refined features.<p>The subsequent GP operates on these extracted features (\(\mathbf{z}\)), using a radial basis function to model correlations in the transformed feature space. The choice of the Radial Basis Function kernel is due to its ability to capture smooth non-linear relationships between variables, being suitable for most regression problems. Other options like periodic or Matérn kernels could be used to capture specific patterns like seasonality or different degrees of smoothness.<p>Joint training simultaneously optimizes the MLP parameters (\(\mathbf{W}_i, \mathbf{b}_i\)) and GP hyperparameters (\(\boldsymbol{\theta}_{GP}\)) through gradient descent<p>\[ \begin{aligned} \mathcal{L}(\mathbf{W}, \mathbf{b}, \boldsymbol{\theta}_{GP}) &= -\log p(\mathbf{y}\mid\text{MLP}(\mathbf{X}), \boldsymbol{\theta}_{GP}) \\ \boldsymbol{\phi}_{t+1} &= \boldsymbol{\phi}_t - \eta \nabla_{\boldsymbol{\phi}} \mathcal{L}(\boldsymbol{\phi}_t), \end{aligned} \]<p>where \(\boldsymbol{\phi} = \{\mathbf{W}, \mathbf{b}, \boldsymbol{\theta}_{GP}\}\) represents all trainable parameters of the hybrid model.<p>This hybrid architecture combines the power of neural networks in extracting complex features with the precision of GPs in uncertainty quantification.<h2 id=exact-gaussian-processes>Exact Gaussian Processes</h2><p>A GP is a family of random variables such that any finite subset follows a multivariate Gaussian distribution<sup class=footnote-reference id=fr-4-3><a href=#fn-4>4</a></sup> <sup class=footnote-reference id=fr-5-3><a href=#fn-5>5</a></sup>. This property guarantees exactness to Bayesian inference without the need to resort to numerical approximations — differs, for example, from Bayesian neural networks, which need Monte Carlo sampling or variational methods.<p>Formally, a GP is specified by its mean function \(m(\mathbf{x})\) and covariance function \(k(\mathbf{x}, \mathbf{x'})\), where<p>\[ \begin{aligned} m(\mathbf{x}) &= \mathbb{E}[f(\mathbf{x})] \\ k(\mathbf{x}, \mathbf{x'}) &= \mathbb{E}[(f(\mathbf{x}) - m(\mathbf{x}))(f(\mathbf{x'}) - m(\mathbf{x'}))] \end{aligned} \]<p>Thus, we have \(f(\mathbf{x}) \sim \mathcal{GP}(m, k)\) to indicate that function \(f\) follows a GP with mean function \(m\) and covariance function \(k\).<p>In the regression problem, given a training sample \(\mathcal{D} = {(\mathbf{x}_i, y_i)}_{i=1}^{n}\) and assuming homoscedastic Gaussian noise \(y_i = f(\mathbf{x}_i) + \varepsilon_i\), where \(\varepsilon_i \sim \mathcal{N}(0, \sigma^2)\), the posterior for a new point \(\mathbf{x}_*\) is Gaussian with parameters<p>\[ \begin{aligned} \mu(\mathbf{x}_*) &= \mathbf{k}_*^\top(\mathbf{K} + \sigma^2\mathbf{I})^{-1}\mathbf{y} \\ \sigma^2(\mathbf{x}_*) &= k(\mathbf{x}_*, \mathbf{x}_*) - \mathbf{k}_*^\top(\mathbf{K} + \sigma^2\mathbf{I})^{-1}\mathbf{k}_* \end{aligned} \]<p>where \(\mathbf{K}\) is the covariance matrix between training points and \(\mathbf{k}_*\) contains the covariances between \(\mathbf{x}_*\) and each \(\mathbf{x}_i\).<p>In this work, to obtain smooth and isotropic sample functions, we use the radial basis function for covariance calculation, defined as<p>\[ k(\mathbf{x}, \mathbf{x'}) = \sigma_f^2 \exp\left(-\frac{||\mathbf{x} - \mathbf{x'}||^2}{{{2l^2}}}\right) \]<p>where \(\sigma_f^2\) is the signal variance and \(l\) is the length scale, which controls function smoothness. These hyperparameters are optimized by maximizing the marginal log-likelihood of the training data. The marginal log-likelihood is obtained by integrating over the latent function \(f\), resulting in<p>\[ \log p(\mathbf{y}|\mathbf{X}, \boldsymbol{\theta}) = -\frac{1}{2}\mathbf{y}^\top(\mathbf{K} + \sigma^2\mathbf{I})^{-1}\mathbf{y} - \frac{1}{2}\log|\mathbf{K} + \sigma^2\mathbf{I}| - \frac{n}{2}\log(2\pi) \]<p>where \(\boldsymbol{\theta}\) are the kernel hyperparameters. This optimization balances data fitting with model complexity.</p><video style="border:5px solid #ef5350;width:100%;max-width:100%;height:auto" autoplay controls loop muted><source src=https://rodolfoviana.com.br/assets/GP.mp4 type=video/mp4> Your browser does not support HTML5 video.</video><h2 id=stochastic-variational-gaussian-process>Stochastic Variational Gaussian Process</h2><p>An important limitation of exact GP is that it requires computational complexity of \(\mathcal{O}(n^3)\) for training and \(\mathcal{O}(n^2)\) for prediction, where \(n\) is the number of training points. Stochastic Variational Gaussian Process (SVGP) reduces these costs to \(\mathcal{O}(nm^{2}+m^{3})\) and \(\mathcal{O}(m^{2})\), respectively, by introducing a set of \(m\) inducing points at \(\mathbf Z={\mathbf z_{j}}_{j=1}^{m}\), with \(m\ll n\)<sup class=footnote-reference id=fr-12-1><a href=#fn-12>12</a></sup> <sup class=footnote-reference id=fr-13-1><a href=#fn-13>13</a></sup> <sup class=footnote-reference id=fr-14-1><a href=#fn-14>14</a></sup> <sup class=footnote-reference id=fr-15-1><a href=#fn-15>15</a></sup>. These inducing points are latent variables that summarize information from the complete training set.<p>In this model, we approximate the posterior distribution \(p(\mathbf{f} \mid \mathcal{D})\) by a variational distribution \(q(\mathbf{f})\), that is,<p>\[ q(\mathbf{f}, \mathbf{u}) = p(\mathbf{f} \mid \mathbf{u})q(\mathbf{u}), \]<p>where \(\mathbf{f}\) are the function values at training points, \(\mathbf{u}\) are the function values at inducing points, \(p(\mathbf{f} \mid \mathbf{u})\) is the GP conditional distribution, and \(q(\mathbf{u})\) is a Gaussian variational distribution with parameters to be optimized.<p>Optimization is performed by minimizing the Kullback-Leibler divergence between the variational distribution and the true posterior distribution. The divergence between two continuous distributions with densities \(p\) and \(q\) is defined as<p>\[ D_{\mathrm{KL}}(P \mid Q) = \int p(x),\ln!\biggl(\frac{p(x)}{q(x)}\biggr),\mathrm{d}x \]<p>Intuitively, \(D_{\mathrm{KL}}(P \mid Q)\) measures the excess information required to represent samples from \(P\) using an optimal code based on \(Q\) instead of an optimal code for \(P\) itself. This divergence is always non-negative and is zero only when, for almost all \(x\), we have \(p(x)=q(x)\).<p>The task of minimizing the divergence is equivalent to maximizing a lower bound on the evidence (ELBO, <em>Evidence Lower Bound</em>).<p>Prediction for a new point \(\mathbf{x}_*\) is given by<p>\[ \begin{aligned} q(f(\mathbf{x}_*)) &= \int p(f(\mathbf{x}_*) \mid \mathbf{u})q(\mathbf{u})d\mathbf{u} \\ &= \mathcal{N}(f(\mathbf{x}_*) \mid \mu_q(\mathbf{x}_*), \sigma_q^2(\mathbf{x}_*)), \end{aligned} \]<p>where<p>\[ \begin{aligned} \mu_q(\mathbf{x}_*) &= \mathbf{k}_{*z}\mathbf{K}_{zz}^{-1}\boldsymbol{\mu}_u \\ \sigma_q^2(\mathbf{x}_*) &= k(\mathbf{x}_*, \mathbf{x}_*) - \mathbf{k}_{*z}\mathbf{K}_{zz}^{-1}(\mathbf{K}_{zz} - \mathbf{S}_u)\mathbf{K}_{zz}^{-1}\mathbf{k}_{z*} \end{aligned} \]<p>where \(\mathbf{k}_{*z}\) is the vector of covariances between \(\mathbf{x}_*\) and the inducing points, \(\mathbf{K}_{zz}\) is the covariance matrix between inducing points, and \(\boldsymbol{\mu}_u\) and \(\mathbf{S}_u\) are the parameters of the variational distribution \(q(\mathbf{u}) = \mathcal{N}(\boldsymbol{\mu}_u, \mathbf{S}_u)\).<p>In this work, inspired by underfitting and numerical instability bottlenecks<sup class=footnote-reference id=fr-16-1><a href=#fn-16>16</a></sup>, we use extensions to the standard SVGP, such as adaptive selection of inducing points based on data distribution, joint optimization of inducing points and kernel hyperparameters, use of mini-batches during training to improve computational efficiency, and implementation of numerical stability techniques, such as Cholesky decomposition<sup class=footnote-reference id=fr-17-1><a href=#fn-17>17</a></sup> — that is, factorization of a symmetric and positive definite matrix \(A\) into \(A = LL^\top\), where \(L\) is a lower triangular matrix with positive diagonal elements — for computing matrix inverses.<p>These improvements allow SVGP to retain the probabilistic interpretation of the classical GP, scale to datasets with hundreds of thousands of samples, and produce prediction intervals that combine statistical validity and competitive width.<h2 id=conformal-prediction>Conformal Prediction</h2><p>Given the probabilistic nature of GP-based models, prediction intervals can be derived directly from the posterior distribution. For a confidence level \(1-\alpha\), the prediction interval for a new point \(\mathbf{x}_*\) is:<p>\[ PI_{1-\alpha}(\mathbf{x}_*) = [\mu(\mathbf{x}_*) - z_{1-\alpha/2} \cdot \sigma(\mathbf{x}_*), \mu(\mathbf{x}_*) + z_{1-\alpha/2} \cdot \sigma(\mathbf{x}_*)] \]<p>where \(z_{1-\alpha/2}\) is the \(1-\alpha/2\) quantile of the standard normal distribution.<p>This prediction interval has a Bayesian interpretation: assuming the model and its hyperparameters are correct, the interval contains the true value with probability \(1-\alpha\). However, in practice, these assumptions may not be valid, leading to intervals that do not achieve the desired nominal coverage. Conformal prediction<sup class=footnote-reference id=fr-9-2><a href=#fn-9>9</a></sup> <sup class=footnote-reference id=fr-10-2><a href=#fn-10>10</a></sup> is a statistical approach that allows calibrating prediction intervals to guarantee theoretical coverage properties, regardless of the underlying data distribution or model adequacy. The central idea is to use a calibration set to determine how much prediction intervals should be contracted to achieve the desired coverage.<p>In this work, we implement a variant of conformal prediction known as inductive conformal prediction<sup class=footnote-reference id=fr-18-1><a href=#fn-18>18</a></sup>, which uses a separate validation set for calibration. Additionally, we make use of a natural non-conformity score, given by<p>\[ s_i = \max\{y_i - l(\mathbf{x}_i), u(\mathbf{x}_i) - y_i, 0\} \]<p>chosen for its simplicity and interpretability: it is the normalized absolute error between prediction and true value; it measures how much the true value is outside the original prediction interval.<p>An important theoretical property of conformal prediction is that, under the assumption of data exchangeability, conformal prediction intervals guarantee marginal coverage of at least \(1-\alpha\) on the test set<sup class=footnote-reference id=fr-7-2><a href=#fn-7>7</a></sup>. This means that, on average, at least a fraction \(1-\alpha\) of intervals will contain the true values, regardless of model adequacy or data distribution.</p><video style="border:5px solid #ef5350;width:100%;max-width:100%;height:auto" autoplay controls loop muted><source src=https://rodolfoviana.com.br/assets/ConformalGPComparison.mp4 type=video/mp4> Your browser does not support HTML5 video.</video><h2 id=test-execution>Test Execution</h2><p>We evaluated the models on three public datasets widely used in regression problems: <em>Combined Cycle Power Plant</em><sup class=footnote-reference id=fr-19-1><a href=#fn-19>19</a></sup> (CCPP), which contains information from a combined cycle power plant, with the objective of predicting net electrical power; <em>Concrete Compressive Strength</em><sup class=footnote-reference id=fr-20-1><a href=#fn-20>20</a></sup> (Concrete), which contains values for different concrete mixtures, with the objective of predicting compressive strength; and <em>Condition Based Maintenance of Naval Propulsion Plants</em><sup class=footnote-reference id=fr-21-1><a href=#fn-21>21</a></sup> (Naval), which contains measurements from a naval propulsion plant, with the objective of predicting the compressor decay state coefficient.<table><thead><tr><th style=text-align:right>Datasets<th style=text-align:center>Dimensionality<th style=text-align:center>Samples<th style=text-align:center>\(y\) Skewness<th style=text-align:center>\(y\) Kurtosis<tbody><tr><td style=text-align:right>CCPP<td style=text-align:center>5<td style=text-align:center>9,568<td style=text-align:center>0.31<td style=text-align:center>1.95<tr><td style=text-align:right>Concrete<td style=text-align:center>9<td style=text-align:center>1,030<td style=text-align:center>0.42<td style=text-align:center>2.69<tr><td style=text-align:right>Naval<td style=text-align:center>18<td style=text-align:center>11,934<td style=text-align:center>0.00<td style=text-align:center>1.80</table><p>These datasets were chosen for representing a variety of domains and characteristics, allowing comprehensive evaluation of models in different contexts. To evaluate the performance of prediction intervals, we used coverage, mean prediction interval width (MPIW) and performance as metrics.<p>Coverage is the fraction of test points for which the true value is contained in the prediction interval. Formally, for a test set with \(n\) points, coverage is<p>\[ \text{Coverage} = \frac{1}{n}\sum_{i=1}^{n}\mathbf{1}\{y_i \in PI(\mathbf{x}_i)\} \]<p>where \(\mathbf{1}\{\cdot\}\) is the indicator function. A good prediction interval should have coverage close to the nominal confidence level (\(1-\alpha\)).<p>MPIW, the mean prediction interval width, is obtained through<p>\[ \text{MPIW} = \frac{1}{n}\sum_{i=1}^{n}(u(\mathbf{x}_i) - l(\mathbf{x}_i)) \]<p>where \(l(\mathbf{x}_i)\) and \(u(\mathbf{x}_i)\) are the lower and upper bounds of the prediction interval for \(\mathbf{x}_i\). A good prediction interval should be as narrow as possible, conditional on achieving the desired coverage.<p>To evaluate point prediction accuracy, we used the coefficient of determination \(R^2\), which measures the proportion of variance in the dependent variable that is predictable from the independent variables. Higher \(R^2\) values indicate better predictive performance.<p>In addition to these main metrics, we also calculated secondary metrics for more detailed analysis, such as the difference between conformal coverage and raw coverage, the difference between conformal mean interval width and raw mean interval width, the fraction of test points for which the true value is below the lower bound or above the upper bound of the prediction interval, the ratio between conformal mean interval width and raw mean interval width, and the ratio between coverage difference and width difference, which measures conformal calibration efficiency.<p>To ensure result robustness, each dataset was trained using five distinct seeds for up to 200 epochs, with the possibility of early stopping if the loss function showed no improvement for 10 consecutive epochs, using a minimum delta of \(1 \times 10^{-6}\) to consider a significant improvement.<h1 id=results>Results</h1><p>The results show interesting patterns in model behavior. First, we observe that raw prediction intervals generally have coverages significantly higher than the nominal level of 90%.<table><thead><tr><th rowspan=2>Model<th rowspan=2>Dataset<th colspan=2>Coverage (%)<th colspan=2>MPIW<th rowspan=2>R²<tr><th>Raw<th>Conformal<th>Raw<th>Conformal<tbody><tr><td rowspan=3>NE-GP<td style=text-align:right>CCPP<td style=text-align:center>99.89<td style=text-align:center>90.13<td style=text-align:center>2.64<td style=text-align:center>0.76<td style=text-align:center>0.941<tr><td style=text-align:right>Concrete<td style=text-align:center>99.03<td style=text-align:center>91.55<td style=text-align:center>2.72<td style=text-align:center>1.47<td style=text-align:center>0.796<tr><td style=text-align:right>Naval<td style=text-align:center>100.00<td style=text-align:center>89.38<td style=text-align:center>2.66<td style=text-align:center>0.83<td style=text-align:center>0.933<tr><td rowspan=3>NE-SVGP<td style=text-align:right>CCPP<td style=text-align:center>90.93<td style=text-align:center>90.13<td style=text-align:center>0.76<td style=text-align:center>0.75<td style=text-align:center>0.945<tr><td style=text-align:right>Concrete<td style=text-align:center>98.83<td style=text-align:center>90.87<td style=text-align:center>2.14<td style=text-align:center>1.18<td style=text-align:center>0.877<tr><td style=text-align:right>Naval<td style=text-align:center>96.65<td style=text-align:center>90.26<td style=text-align:center>0.52<td style=text-align:center>0.39<td style=text-align:center>0.984</table><p>The table shows that, in the case of NE-GP, raw prediction coverages vary from 99.03% to 100.00%, while for NE-SVGP they vary from 90.93% to 98.83%. This indicates that raw prediction intervals are frequently overly conservative, resulting in higher than necessary coverage.<p>After applying the conformal method, coverages are consistently adjusted to values close to 90%, which is the desired nominal coverage level. This result confirms the effectiveness of conformal prediction in calibrating prediction intervals to achieve desired coverage, regardless of model or dataset.</p><img style="border:5px solid #ef5350;width:100%;max-width:100%;height:auto" src=./combined_models_all_datasets.png><p>The figure, with results from executions on seed 42, illustrates the trade-off between coverage and interval width. With NE-GP, across all datasets, conformal calibration reduces coverage to approximately 90%, while also reducing interval width. The effect is particularly pronounced in the CCPP dataset, where mean width is reduced from 2.64 to 0.76, a reduction of 71.2%, while coverage goes from 99.89% to 90.13%.<p>Similarly, for NE-SVGP, we observe a similar pattern, but with some notable differences. In particular, raw intervals are generally already narrower compared to the NE-GP model, and the proportional reduction in width after conformal calibration is smaller. For example, in the CCPP dataset, mean width is reduced from 0.76 to 0.75, a reduction of only 1.3%, while coverage goes from 90.93% to 90.13%.<p>Regarding performance, we see that NE-SVGP significantly outperforms NE-GP on the Naval (0.984 vs. 0.933) and Concrete (0.877 vs. 0.796) datasets, in addition to showing slightly superior performance on the CCPP dataset (0.945 vs. 0.941).<p>In addition to these metrics, results can also be evaluated by the percentage of errors that, after conformal prediction, are distributed between the lower and upper bounds; by the ratio between conformal mean interval width and raw mean interval width, where smaller values indicate a more significant reduction after applying the conformal method; by the reduction in excess coverage, which measures conformal prediction efficiency by quantifying the gain obtained per unit of width reduction; and by calibration error, that is, the absolute difference between achieved coverage and the nominal level of 90%.<table><thead><tr><th rowspan=2>Model<th rowspan=2>Dataset<th colspan=2>Errors (%)<th rowspan=2>Width Ratio<th rowspan=2>Excess Coverage Reduction<th colspan=2>Calibration Error<tr><th>Lower<th>Upper<th>Raw<th>Conformal<tbody><tr><td rowspan=3>NE-GP<td style=text-align:right>CCPP<td style=text-align:center>4.22<td style=text-align:center>5.65<td style=text-align:center>0.289<td style=text-align:center>0.052<td style=text-align:center>0.099<td style=text-align:center>0.002<tr><td style=text-align:right>Concrete<td style=text-align:center>4.27<td style=text-align:center>4.17<td style=text-align:center>0.541<td style=text-align:center>0.060<td style=text-align:center>0.090<td style=text-align:center>0.020<tr><td style=text-align:right>Naval<td style=text-align:center>7.63<td style=text-align:center>2.98<td style=text-align:center>0.310<td style=text-align:center>0.058<td style=text-align:center>0.100<td style=text-align:center>0.008<tr><td rowspan=3>NE-SVGP<td style=text-align:right>CCPP<td style=text-align:center>4.25<td style=text-align:center>5.62<td style=text-align:center>0.976<td style=text-align:center>0.339<td style=text-align:center>0.009<td style=text-align:center>0.005<tr><td style=text-align:right>Concrete<td style=text-align:center>3.69<td style=text-align:center>5.44<td style=text-align:center>0.551<td style=text-align:center>0.083<td style=text-align:center>0.088<td style=text-align:center>0.020<tr><td style=text-align:right>Naval<td style=text-align:center>8.35<td style=text-align:center>1.38<td style=text-align:center>0.750<td style=text-align:center>0.553<td style=text-align:center>0.066<td style=text-align:center>0.006</table><p>The table reveals interesting patterns in error distribution and conformal calibration effectiveness. For NE-GP, we observe a relatively balanced error distribution between lower and upper bounds in the CCPP (4.22% lower vs. 5.65% upper) and Concrete (4.27% lower vs. 4.17% upper) datasets, while the Naval dataset shows notable asymmetry with 7.63% of errors at the lower bound against only 2.98% at the upper bound.<p>The width ratio confirms conformal calibration effectiveness in significantly reducing interval width. For NE-GP, we observe substantial reductions: CCPP with a ratio of 0.289 (71.1% reduction), Concrete with 0.541 (45.9% reduction) and Naval with 0.310 (69.0% reduction). NE-SVGP shows distinct behavior, with a more modest reduction in CCPP (ratio of 0.976, only 2.4%) but significant reductions in Concrete (0.551, 44.9% reduction) and Naval (0.750, 25.0% reduction).<p>Calibration error demonstrates conformal prediction superiority. For NE-GP, raw calibration errors vary from 0.090 to 0.100, being consistently reduced to values close to zero after conformal calibration (0.002 to 0.020). NE-SVGP already shows smaller raw calibration errors (0.009 to 0.088), but still benefits from conformal calibration, achieving final errors of 0.005 to 0.020.<h1 id=conclusion>Conclusion</h1><p>This work investigated in depth the integration of Gaussian processes enhanced by neural networks with conformal prediction as a strategy for calibrating prediction intervals. The results obtained on three datasets of diverse nature show that conformation provides substantial gains both in statistical reliability and informational efficiency.<p>Before calibration, raw intervals exhibited coverages much higher than the nominal level of 90%, reaching 100% in NE-GP for the Naval dataset and 99.89% in CCPP. This excess coverage, while seeming desirable at first glance, reveals excessively wide and therefore not very useful intervals in practice. The application of conformal prediction systematically adjusted coverage to values very close to 90%, confirming, in practice, the theoretical guarantees of the method: marginal coverage converges to the defined level regardless of model fit or data distribution.<p>The efficiency of this adjustment was directly reflected in the mean width of intervals. In the most expressive scenario, CCPP with NE-GP suffered a 71.2% reduction in width after calibration, from 2.64 to 0.76 units, without compromising the required hit rate. Even in NE-SVGP, where initial widths were already smaller due to the sparse variational nature of the model, additional reduction was observed that, although more modest in CCPP (1.3%), reached considerable values in Concrete (44.9%) and Naval (25%).<p>These findings highlight a central point: conformal calibration not only corrects coverage, but also tends to remove statistical redundancy, compressing intervals to the limit necessary to preserve the confidence level. In other words, it transforms superabundant uncertainty into useful information.<p>The contrast between the two evaluated models provides additional observations. NE-SVGP, thanks to the use of inducing points and variational optimization, achieved superior predictive performance in terms of \(R^2\), reaching 0.984 in the Naval dataset, and produced narrower raw intervals than NE-GP. Even so, it did not dispense with calibration: small coverage violations or asymmetries in error distribution were corrected after conformation.<p>For NE-GP, dependence on calibration was even more explicit, given the model's tendency to overestimate uncertainty in domains with high noise or feature imbalance. Therefore, conformal prediction proved to be a robust complement to both paradigms: it acts as a "second line of defense" against model specification defects and failures in homoscedastic noise assumptions or independent and identically distributed distributions.<p>Despite these successes, some limitations deserve attention. First, the natural extension of this work involves explicit incorporation of heteroscedasticity, either through local variational GPs or hybrid models that learn conditional output variance. Second, although SVGP scales better than exact GP, datasets with millions of samples may require hierarchical partitioning that preserves conformal prediction guarantees.<p>Furthermore, the investigation was restricted to regression tasks. Since the theoretical structure of conformal is loss function agnostic, there is fertile ground for exploring ordinal classifications, anomaly detection, and interval prediction in time series, where exchangeability assumptions need to be revisited.<h1 id=references>References</h1><footer class=footnotes><ol class=footnotes-list><li id=fn-1><p>GAL, Y. <em>Uncertainty in deep learning</em>. Thesis (PhD) — University of Cambridge, Cambridge, 2016. <a href=#fr-1-1>↩</a></p><li id=fn-2><p>KULESHOV, V.; FENNER, N.; ERMON, S. Accurate uncertainties for deep learning using calibrated regression. In: <em>International Conference on Machine Learning</em>, 35., 2018, p. 2796–2804. <a href=#fr-2-1>↩</a></p><li id=fn-3><p>HÜLLERMEIER, E.; WAEGEMAN, W. Aleatoric and epistemic uncertainty in machine learning: an introduction to concepts and methods. <em>Machine Learning</em>, v. 110, n. 3, p. 457–506, 2021. <a href=#fr-3-1>↩</a></p><li id=fn-4><p>RASMUSSEN, C. E.; WILLIAMS, C. K. I. <em>Gaussian processes for machine learning</em>. Cambridge, MA: MIT Press, 2005. <a href=#fr-4-1>↩</a> <a href=#fr-4-2>↩2</a> <a href=#fr-4-3>↩3</a></p><li id=fn-5><p>MURPHY, K. P. <em>Machine learning: a probabilistic perspective</em>. Cambridge, MA: MIT Press, 2012. <a href=#fr-5-1>↩</a> <a href=#fr-5-2>↩2</a> <a href=#fr-5-3>↩3</a></p><li id=fn-6><p>KENDALL, A.; GAL, Y. What uncertainties do we need in Bayesian deep learning for computer vision? In: <em>Proceedings of the 31st Annual Conference on Neural Information Processing Systems (NIPS'17)</em>, Long Beach, CA, USA, p. 5580–5590, 2017. <a href=#fr-6-1>↩</a></p><li id=fn-7><p>ANGELOPOULOS, A. N.; BATES, S. A gentle introduction to conformal prediction and distribution-free uncertainty quantification. <em>arXiv preprint arXiv:2107.07511</em>, 2022. <a href=#fr-7-1>↩</a> <a href=#fr-7-2>↩2</a></p><li id=fn-8><p>BALASUBRAMANIAN, V.; HO, S.-S.; VOVK, V. <em>Conformal prediction for reliable machine learning: theory, adaptations and applications</em>. 1. ed. San Francisco: Morgan Kaufmann Publishers Inc., 2014. <a href=#fr-8-1>↩</a></p><li id=fn-9><p>VOVK, V.; GAMMERMAN, A.; SHAFER, G. <em>Algorithmic learning in a random world</em>. New York, NY: Springer, 2005. <a href=#fr-9-1>↩</a> <a href=#fr-9-2>↩2</a></p><li id=fn-10><p>SHAFER, G.; VOVK, V. A tutorial on conformal prediction. <em>The Journal of Machine Learning Research</em>, v. 9, p. 371–421, 2008. <a href=#fr-10-1>↩</a> <a href=#fr-10-2>↩2</a></p><li id=fn-11><p>LEI, J.; G'S ELL, M.; RINALDO, A.; TIBSHIRANI, R. J.; WASSERMAN, L. Distribution-free predictive inference for regression. <em>Journal of the American Statistical Association</em>, v. 113, n. 523, p. 1094–1111, 2018. <a href=#fr-11-1>↩</a></p><li id=fn-12><p>QUINONERO-CANDELA, J.; RASMUSSEN, C. E. A unifying view of sparse approximate Gaussian process regression. <em>Journal of Machine Learning Research</em>, v. 6, n. 65, p. 1939–1959, 2005. <a href=#fr-12-1>↩</a></p><li id=fn-13><p>SNELSON, E.; GHAMRAMANI, Z. Sparse Gaussian processes using pseudo-inputs. In: <em>Advances in Neural Information Processing Systems</em>, v. 18, p. 1257–1264, 2005. MIT Press. <a href=#fr-13-1>↩</a></p><li id=fn-14><p>TITSIAS, M. Variational learning of inducing variables in sparse Gaussian processes. In: <em>Proceedings of the Twelfth International Conference on Artificial Intelligence and Statistics</em>, 5., Clearwater, FL: PMLR, p. 567–574, 2009. <a href=#fr-14-1>↩</a></p><li id=fn-15><p>HENSMAN, J.; FUSI, N.; LAWRENCE, N. D. Gaussian processes for big data. In: <em>Proceedings of the Twenty-Ninth Conference on Uncertainty in Artificial Intelligence</em>, Bellevue, WA; Arlington, VA: AUAI Press, p. 282–290, 2013. <a href=#fr-15-1>↩</a></p><li id=fn-16><p>DEWOLF, N.; DE BAETS, B.; WAEGEMAN, W. Valid prediction intervals for regression problems. <em>Artificial Intelligence Review</em>, v. 56, n. 1, p. 577–613, 2023. <a href=#fr-16-1>↩</a></p><li id=fn-17><p>GOLUB, G. H.; VAN LOAN, C. F. <em>Matrix computations</em>. 4. ed. Baltimore, MD: Johns Hopkins University Press, 2013. <a href=#fr-17-1>↩</a></p><li id=fn-18><p>PAPADOPOULOS, H.; PROEDROU, K.; VOVK, V.; GAMMERMAN, A. Inductive confidence machines for regression. In: <em>Machine Learning: ECML 2002</em>, Berlin; Heidelberg: Springer Berlin Heidelberg, p. 345–356, 2002. <a href=#fr-18-1>↩</a></p><li id=fn-19><p>TFEKCI, P.; KAYA, H. Combined cycle power plant. UCI Machine Learning Repository, 2014. <a href=#fr-19-1>↩</a></p><li id=fn-20><p>YEH, I.-C. Concrete compressive strength. UCI Machine Learning Repository, 1998. <a href=#fr-20-1>↩</a></p><li id=fn-21><p>CORADDU, A.; ONETO, L.; GHIO, A.; SAVIO, S.; ANGIUTA, D.; FIGARI, M. Condition based maintenance of naval propulsion plants. UCI Machine Learning Repository, 2014. <a href=#fr-21-1>↩</a></p></ol></footer></section></article></main><footer class=footer><div class=footer-content><div class=footer-left>© 2025 Rodolfo Viana</div><div class=footer-right>Made with <a href=https://www.getzola.org/ rel=noopener target=_blank>Zola</a>, <a href=https://github.com/not-matthias/apollo rel=noopener target=_blank>Apollo</a></div></div></footer></div>